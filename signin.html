<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>로그인</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" />

    <link rel="stylesheet" href="/assets/css/sign.css" />
  </head>
  <body>
    <header>
      <div class="header_container">
        <a class="header_container_logo" href="/"><img src="/assets/images/index/logo.svg" alt="홈으로 연결된 Linkbrary 로고" /></a>
        <p class="header_container__p">회원이 아니신가요?<a class="header_container__a" href="./signup.html">회원 가입하기</a></p>
      </div>
    </header>

    <div class="sign_box">
      <form id="login-form" class="sign-form" action="">
        <div class="sign_box_inputs">
          <div class="sign_box_input">
            <label for="email">이메일</label>
            <input type="text" name="email" id="email" />
            <p class="error_msg"></p>
          </div>
          <div class="sign_box_input sign-password">
            <label for="password">비밀번호 </label>
            <input type="password" name="password" id="password" />
            <button class="eye-button" type="button">
              <img src="/assets/images/signin/eye-off.svg" />
            </button>
            <p class="error_msg"></p>
          </div>
        </div>
        <input type="submit" value="로그인" />
      </form>

      <div class="singin_oauth">
        <p>소셜 로그인</p>
        <div class="sign_oauth__icon">
          <a href="https://www.google.com" target="_blank"><img src="/assets/images/signin/google.png" alt="" /></a>
          <a href="https://www.kakaocorp.com/page" target="_blank"><img src="/assets/images/signin/kakao.png" alt="" /></a>
        </div>
      </div>
    </div>
    <script>
      const input_email = document.querySelector('#email');
      const input_pw = document.querySelector('#password');
      const input_pw_chk = document.querySelector('#password_chk');
      const sign_form = document.querySelector('.sign-form');
      const error_msg = document.querySelectorAll('.error_msg');

      input_email.addEventListener('focusout', e => {
        validateEmail(e);
      });

      input_pw.addEventListener('focusout', e => {
        validatePassWord(e);
      });

      sign_form.addEventListener('submit', validateLogin);

      function validateLogin(e) {
        if (validateEmail(e) && validatePassWord(e)) {
          if (verifyUserLogin) {
            sign_form.action = '/folder';
            sign_form.method = 'post';
            sign_form.submit();
          }
        }
      }

      function validateEmail(e) {
        e.preventDefault();
        var regex =
          /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;

        if (input_email.value.length == 0) {
          error_msg[0].innerHTML = '이메일을 입력해주세요';

          e.target.classList.add('input-error');
          return false;
        }
        if (regex.test(input_email.value) === false) {
          error_msg[0].innerHTML = '올바른 이메일 주소가 아닙니다.';
          e.target.classList.add('input-error');
          return false;
        }

        error_msg[0].innerHTML = '';
        e.target.classList.remove('input-error');

        return true;
      }

      function validatePassWord(e) {
        e.preventDefault();
        if (input_pw.value.length == 0) {
          error_msg[1].innerHTML = '비밀번호를 입력해주세요.';
          e.target.classList.add('input-error');
          return false;
        }

        error_msg[1].innerHTML = '';
        e.target.classList.remove('input-error');

        return true;
      }

      function verifyUserLogin() {
        if (input_email.value != 'test@codeit.com' && e.type === 'submit') {
          error_msg[0].innerHTML = '이메일을 확인해주세요';
          return false;
        }
        if (input_pw.value != 'codeit101' && e.type === 'submit') {
          error_msg[1].innerHTML = '비밀번호를 확인해주세요';
          return false;
        }

        e.target.classList.remove('input-error');

        return true;
      }
    </script>
  </body>
</html>
